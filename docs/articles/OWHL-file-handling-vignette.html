<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OWHL file handling • owhlR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="OWHL file handling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">owhlR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OWHL-file-handling-vignette.html">OWHL file handling</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/millerlp/owhlR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>OWHL file handling</h1>
                        <h4 class="author">Luke Miller</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/millerlp/owhlR/blob/master/vignettes/OWHL-file-handling-vignette.Rmd"><code>vignettes/OWHL-file-handling-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>OWHL-file-handling-vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>owhlR</code> package was originally created to support the post-processing workflow of the Open Wave Height Logger (OWHL) project. The package contains functions to assist in combining raw csv files from a OWHL device, and this vignette contains a walkthrough of the steps involved in proceeding from raw pressure data contained in an OWHL csv file to a time series of sea surface elevation data that can be used to generate oecan wave statistics.</p>
</div>
<div id="starting-out" class="section level1">
<h1 class="hasAnchor">
<a href="#starting-out" class="anchor"></a>Starting out</h1>
<p>The <code>owhlR</code> package relies on functions contained in the <code>oceanwaves</code> package, and further dependencies of that package.</p>
<p>Begin by installing the <code>oceanwaves</code> package, if not already installed. The <code>oceanwaves</code> package makes use of several other packages that may also need to be installed.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">'oceanwaves'</span>)</a></code></pre></div>
<p>Load the installed package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(oceanwaves)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Loading required package: ggplot2</span></a></code></pre></div>
</div>
<div id="importing-owhl-csv-files" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-owhl-csv-files" class="anchor"></a>Importing OWHL csv files</h1>
<p>The Open Wave Height Logger produces daily datafiles, in a comma-separated-value (.csv) format. Those files contain a header row with optional deployment information, along with a row of column headers. The import process would normally begin by generating a vector of filenames (include file path) that you want to join. The <code><a href="https://www.rdocumentation.org/packages/base/topics/list.files">dir()</a></code> function can be used to generate the set of filenames.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">filenames &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">dir</a></span>(<span class="dt">path=</span><span class="st">"."</span>, <span class="dt">pattern =</span> <span class="st">'*.csv'</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>The set of filenames can be passed to the <code>joinOWHLfiles</code> function. This function has an argument <code>timezone</code> (default <code>timezone = UTC</code>) used to set the time zone of the time stamps contained in the OWHL data files. If the clock of your OWHL was set to a time zone other than UTC, then supply the appropriate time zone name for your clock. For example, if your OWHL clock was instead set to Pacific Standard Time during the deployment, you would set the argument as <code>timezone = 'etc/GMT+8'</code>. Verbose output for the file import can be turned on with the <code>verbose = TRUE</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">myTimeZone =<span class="st"> 'UTC'</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">dat =<span class="st"> </span>owhlR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/owhlR/topics/joinOWHLfiles">joinOWHLfiles</a></span>(filenames, <span class="dt">timezone =</span> myTimeZone, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>The <code>joinOWHLfiles</code> function consists of several steps:</p>
<ul>
<li>Grab mission info (if present) from the header of the 1st csv file. This assumes that mission info is the same in all input files, which is the case if all files came from a single deployment of the OWHL.</li>
<li>Read in each csv file in a loop.</li>
<li>The human-readable timestamp data in a csv file’s DateTime column are converted to POSIXct time format with the desired time zone.</li>
<li>The DateTime values then have the fractional seconds appended based on the values in the <code>frac.seconds</code> column of the csv file.</li>
<li>Concatenates the data from all input csv files and reorders them based on the DateTime column</li>
<li>Any suspect time values (based on the <code>frac.seconds</code> column values) are filtered and removed from the data set.</li>
<li>Any 1 second gaps in the data set are filled by linear interpolation. These gaps arise in the raw data files when a micro SD card takes longer than the sample interval (default 0.25 seconds) to carry out its internal housekeeping routines. Longer gaps are assumed to be due to other issues and are not filled. The pressure data and temperature data are filled by linear interpolation from the values immediately before and after the missing second of data.</li>
</ul>
<p>After carrying out these steps, a data frame is returned. The data frame should contain the same columns as the original input csv files.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(dat)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;       POSIXt            DateTime frac.seconds Pressure.mbar TempC</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 1 1471630800 2016-08-19 18:20:00            0        1029.3 30.44</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 2 1471630800 2016-08-19 18:20:00           25        1029.6 30.44</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 3 1471630800 2016-08-19 18:20:00           50        1029.0 30.44</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 4 1471630800 2016-08-19 18:20:00           75        1028.5 30.45</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 5 1471630801 2016-08-19 18:20:01            0        1029.0 30.44</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 6 1471630801 2016-08-19 18:20:01           25        1029.0 30.44</span></a></code></pre></div>
</div>
<div id="converting-pressure-to-sea-surface-elevation" class="section level1">
<h1 class="hasAnchor">
<a href="#converting-pressure-to-sea-surface-elevation" class="anchor"></a>Converting pressure to sea surface elevation</h1>
<div id="removing-atmospheric-pressure-and-sensor-offset" class="section level2">
<h2 class="hasAnchor">
<a href="#removing-atmospheric-pressure-and-sensor-offset" class="anchor"></a>Removing atmospheric pressure and sensor offset</h2>
<p>The <code>pressure.mbar</code> values in the resulting data frame are absolute pressures in millibar. This includes the pressure signal due to the air above the sea surface, which we will need to remove from the data in order to get only the pressure due to the column of water above the OWHL sensor. The sea level atmospheric pressure could come from a variety of sources including nearby weather stations. Ideally this would be a time series of atmospheric pressure records that aligns with the OWHL time series. For this example, we will just use a single average value for the entire time series based on the pressure reading at the start of the deployment of 1014 mbar.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">atmosPressure.mbar =<span class="st"> </span><span class="dv">1014</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dat<span class="op">$</span>swPressure.mbar =<span class="st"> </span>dat<span class="op">$</span>Pressure.mbar <span class="op">-</span><span class="st"> </span>atmosPressure.mbar</a></code></pre></div>
<p>It is also important to judge whether the OWHL sensor had any pressure offset due to factors such as manufacturing variance in the pressure sensor chip or residual pressure in the oil-filled bladder attached to the sensor (if used). One method to remove any offset is to compare a set of pressure readings from the data set while the OWHL was at the sea surface just prior to deployment underwater. Ideally the value recorded by the OWHL at the ocean surface would be equivalent to the local atmospheric pressure, but any difference that exists can be removed from the entire timeseries.</p>
<p>Here we’ll define a time value when the OWHL was known to be at the ocean surface, in the boat, just before being taken underwater. Then we find the row index in the <code>dat</code> data frame that is closest to that time stamp, and extract 10 seconds of data (40 samples at 4 Hz), and calculate the average pressure reading. This assumes that you have included the data from the surface period prior to the deployment, which we will remove at a later step.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Define a time value for a surface reading for OWHL prior to </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co"># the start of the subsurface deployment</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">owhlSurfaceTime =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">'2016-08-19 18:25'</span>, <span class="dt">tz =</span> <span class="st">'UTC'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># Find the row index of the timestamp in the dataset that is</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># closest to the surface time we just created</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">surfaceIndx =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which.min">which.min</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(dat<span class="op">$</span>DateTime <span class="op">-</span><span class="st"> </span>owhlSurfaceTime))</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># Grab 10 seconds of surface pressure readings. This will be used to determine</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># any pressure offset in the sensor, when compared to local sea surface air</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co"># pressure at the time of deployment.</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">surfaceOWHLPress =<span class="st"> </span>dat<span class="op">$</span>Pressure.mbar[surfaceIndx<span class="op">:</span>(surfaceIndx<span class="op">+</span><span class="dv">40</span>)]</a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># Round off to a sensible number of significant figures</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">surfaceOWHLPress =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(surfaceOWHLPress),<span class="dt">dig=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-15" data-line-number="15"></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co"># Calculate the offset from the known sea level atmospheric pressure</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co"># (usally obtained from a weather station)</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">offsetValue =<span class="st"> </span>surfaceOWHLPress <span class="op">-</span><span class="st"> </span>atmosPressure.mbar</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co"># Subtract offsetValue from all pressure values</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21">dat<span class="op">$</span>swPressure.mbar =<span class="st"> </span>dat<span class="op">$</span>swPressure.mbar <span class="op">-</span><span class="st"> </span>offsetValue</a></code></pre></div>
<p>After subtracting off the atmospheric pressure and any offset from the absolute pressure values in the raw data files, we are left with the gauge pressure, the pressure due only to the water column above the pressure sensor (with the caveat that strong currents could impinge on a sensor port strongly enough to induce a small pressure signal that isn’t due purely to the pressure head above the sensor).</p>
</div>
<div id="isolate-the-subsurface-portion-of-the-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#isolate-the-subsurface-portion-of-the-dataset" class="anchor"></a>Isolate the subsurface portion of the dataset</h2>
<p>Now would be a reasonable time to subset out only the data from the underwater portion of the deployment, if there are pre- and post-deployment data currently in the <code>dat</code> data frame. Define a set of time stamps that mark when the OWHL was securely mounted in its fixture near the seafloor. Then use those time stamps to remove data before or after the deployment.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Create timestamps when the sensor was in place on the seafloor</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">owhlDeployStartTime =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">'2016-08-19 18:58'</span>, <span class="dt">tz =</span> <span class="st">'UTC'</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">owhlDeployEndTime =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.POSIXlt">as.POSIXct</a></span>(<span class="st">'2016-09-27 19:10'</span>, <span class="dt">tz =</span> <span class="st">'UTC'</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># Remove all surface data prior to deployment and after end</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">dat =<span class="st"> </span>dat[dat<span class="op">$</span>DateTime <span class="op">&gt;=</span><span class="st"> </span>owhlDeployStartTime,]</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">dat =<span class="st"> </span>dat[dat<span class="op">$</span>DateTime <span class="op">&lt;=</span><span class="st"> </span>owhlDeployEndTime,]</a></code></pre></div>
</div>
<div id="convert-pressure-to-sea-surface-elevation" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-pressure-to-sea-surface-elevation" class="anchor"></a>Convert pressure to sea surface elevation</h2>
<p>To convert pressure values to sea surface elevation (height of the water column above the sensor), we’ll use the <code>millibarToSeawater</code> function, which is a wrapper around the <code>swDepth</code> function from the <code>oce</code> package (Kelley &amp; Richards, 2019, <a href="https://CRAN.R-project.org/package=oce" class="uri">https://CRAN.R-project.org/package=oce</a>). The defaults for the <code>swDepth</code> function are used, which call the <code>gsw_z_from_p()</code> function from the package <code>gsw</code>, which is based on from the 75-term equation for specific volume described at <a href="http://www.teos-10.org/" class="uri">http://www.teos-10.org/</a> (Thermodynamic Equation of Seawater 2010). This conversion relies on knowing the latitude where the pressure data were collected, so you need to provide that value as either a positive (Northern Hemisphere) or negative (Southern Hemisphere) decimal value.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Create a new column in dat with the estimated depth calculated</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># from the pressure in millibar. The latitude of the example</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># deployment was approximately 33.72 (degrees North).</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">dat<span class="op">$</span>swDepth.m =<span class="st"> </span>owhlR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/owhlR/topics/millibarToSeawater">millibarToSeawater</a></span>(dat<span class="op">$</span>swPressure.mbar, <span class="dt">latitude =</span> <span class="fl">33.72</span>)</a></code></pre></div>
</div>
<div id="correcting-for-pressure-attenuation" class="section level2">
<h2 class="hasAnchor">
<a href="#correcting-for-pressure-attenuation" class="anchor"></a>Correcting for pressure attenuation</h2>
<p>If your sea surface elevation data were produced by a pressure transducer data logger mounted near the sea floor, rather than a surface buoy, the dynamic pressure signal that the data logger records will be muted to some degree depending on the depth of the data logger and the wave period. As a result, the sea surface elevation record from the bottom-mounted sensor will be an underestimate of what the actual height of the water column above the sensor was, and this underestimate gets worse as the depth of the sensor increases or the wave period gets shorter. The <code>oceanwaves</code> package provides a function <code>prCorr</code> that attempts to correct for this pressure signal attenuation and thus better recreate the actual water surface height fluctuations (a.k.a. waves).</p>
<p>The <code>prCorr</code> function needs a few arguments to work. In addition to the vector of sea surface elevations (in meters), you also need to provide the sampling frequency <code>Fs</code> for the data logger (4 Hz, i.e. 4 samples per second, in our example dataset), and the height <code>zpt</code> of the data logger above the sea floor in units of meters. The height of the pressure sensor above the sea floor matters because the height of waves at the surface is driven by their interaction with the seafloor, and the pressure signal attenuation is also a function of where in the water column the sensor sits. In many cases the sensor will be situated just above the seafloor, but there may be cases where the pressure sensor is strapped to a pier piling or other platform much closer to the surface than the seafloor. For the example data set, the sensor height above the seafloor <code>zpt</code> was 0.1 meters (10 cm).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Define the sampling rate for the example data set</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">Fs =<span class="st"> </span><span class="dv">4</span>  <span class="co"># units of Hz (samples per second)</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">dat<span class="op">$</span>swDepthCorrected.m =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/oceanwaves/topics/prCorr">prCorr</a></span>(dat<span class="op">$</span>swDepth.m, <span class="dt">Fs =</span> Fs, <span class="dt">zpt =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p>We’ll plot the corrected data and the uncorrected data on the same plot to show how the pressure attenuation correction changes the estimated sea surface elevations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Plot the de-attenuated data</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> dat<span class="op">$</span>DateTime, </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">     <span class="dt">y =</span> dat<span class="op">$</span>swDepthCorrected.m, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">'red'</span>, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">     <span class="dt">ylab =</span> <span class="st">'Surface elevation, m'</span>, <span class="dt">xlab =</span> <span class="st">'Time'</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> dat<span class="op">$</span>DateTime, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">      <span class="dt">y =</span> dat<span class="op">$</span>swDepth.m, <span class="dt">col =</span> <span class="st">'blue'</span>) <span class="co"># Add the original data</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">'topright'</span>,<span class="dt">legend=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Corrected'</span>,<span class="st">'Raw'</span>), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'red'</span>,<span class="st">'blue'</span>),</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">       <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure">
<img src="OWHL-file-handling-vignette_files/figure-html/deattenuationFigure1-1.png" alt="Comparison of the raw surface elevation (blue) and pressure-attenuation-corrected surface elevation (red). Pressure signal attenuation causes the true surface elevation fluctuation to be underestimated, and the correction attempts to undo that." width="768"><p class="caption">
Comparison of the raw surface elevation (blue) and pressure-attenuation-corrected surface elevation (red). Pressure signal attenuation causes the true surface elevation fluctuation to be underestimated, and the correction attempts to undo that.
</p>
</div>
<p>Below we’ll plot the short time series of sea surface elevations derived from our input csv files.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">cols =<span class="st"> '#E41A1C'</span>  <span class="co"># red color</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">ylabloc =<span class="st"> </span><span class="fl">3.2</span>  <span class="co"># line location for y-axis labels</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">mybg =<span class="st"> 'grey80'</span> <span class="co"># color for plot backgrounds</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">op &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">######################################</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co"># Plot surface elevation record</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> dat<span class="op">$</span>DateTime,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">        <span class="dt">y =</span> dat<span class="op">$</span>swDepthCorrected.m,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">        <span class="dt">type =</span> <span class="st">'n'</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">''</span>, <span class="dt">xaxt=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">        <span class="dt">xlab =</span> <span class="st">'Time'</span>, <span class="dt">col =</span> cols)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/rect">rect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">1</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">3</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">2</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">4</span>],<span class="dt">col=</span>mybg)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/grid">grid</a></span>(<span class="dt">col =</span><span class="st">'white'</span>)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/box">box</a></span>()</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(dat<span class="op">$</span>DateTime, </a>
<a class="sourceLine" id="cb12-15" data-line-number="15">        dat<span class="op">$</span>swDepthCorrected.m, <span class="dt">col =</span> cols)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/mtext">mtext</a></span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> ylabloc<span class="fl">+0.7</span>, <span class="dt">text =</span> <span class="st">'Surface elevation, m'</span>)</a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/axis">axis</a></span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime), </a>
<a class="sourceLine" id="cb12-18" data-line-number="18">     <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime),<span class="dt">format=</span><span class="st">'%H:%M'</span>) )</a></code></pre></div>
<div class="figure">
<img src="OWHL-file-handling-vignette_files/figure-html/waveRecordPlot-1.png" alt="Time series of surface elevations." width="768"><p class="caption">
Time series of surface elevations.
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(op)</a></code></pre></div>
<p>At this point, the de-attenuated sea surface elevation data in the <code>dat$swDepthCorrected.m</code> column can be used to calculate various wave statistics.</p>
</div>
<div id="calculating-wave-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-wave-statistics" class="anchor"></a>Calculating wave statistics</h2>
<p>Wave statistics are generally calculated for discrete chunks of time, often in the range of 15 to 30 minutes. If the original data were collected in non-contiguous chunks of time (such as a 15 minute sampling burst followed by 45 minutes of no data collection) then the time series in <code>dat</code> will already have natural boundaries for each burst to be analyzed due to gaps in the <code>DateTime</code> column values. If instead the data were collected continuously, as the OWHL is capable of doing, it would be necessary to create our own boundaries for each chunk of time to be analyzed. Our example data set in this vignette is short, so we will analyze the data in 5 minute chunks just for demonstration purposes.</p>
<p>The <code>processBursts</code> function takes several arguments. You need to provide a vector of sea surface elevations (in meters), a vector of <code>POSIXct</code> time stamps, the length of each burst you want to analyze (in minutes), the sampling rate of the sensor (default 4Hz for a OWHL), the method of analysis you want to use to generate the wave statistics (<code>sp</code> for spectral analysis, <code>zc</code> for zero-crossing wave-by-wave analysis), and the time zone of your input data.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Go through each time chunk and calculate the wave</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co"># height and period of the de-trended data (removing tide signal).</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">wavesSP =<span class="st"> </span>owhlR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/owhlR/topics/processBursts">processBursts</a></span>(<span class="dt">Ht =</span> dat<span class="op">$</span>swDepthCorrected.m,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                          <span class="dt">times =</span> dat<span class="op">$</span>DateTime,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                          <span class="dt">burstLength =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                          <span class="dt">Fs =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">                          <span class="dt">method =</span> <span class="st">'sp'</span>,</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">                          <span class="dt">tzone =</span> <span class="st">'UTC'</span>)</a></code></pre></div>
<p>The results for the spectral analysis of wave data are shown below. The output includes:</p>
<ul>
<li><p><code>h</code> - Average water depth. Same units as input surface elevations (typically meters).</p></li>
<li><p><code>Hm0</code> - Significant wave height based on spectral moment 0. Same units as input surface heights (typically meters). This is approximately equal to the average height of the highest 1/3 of the waves.</p></li>
<li><p><code>Tp</code> - Peak period, calculated as the frequency with maximum power in the power spectrum. Units of seconds.</p></li>
<li><p><code>m0</code> - Estimated variance of time series (moment 0).</p></li>
<li><p><code>T_0_1</code> Average period calculated as <span class="math inline">\(\frac{m0}{m1}\)</span>, units seconds. Follows National Data Buoy Center’s method for average period (APD).</p></li>
<li><p><code>T_0_2</code> Average period calculated as <span class="math inline">\((\frac{m0}{m2})^{0.5}\)</span>, units seconds. Follows Scripps Institution of Oceanography’s method for calculating average period (APD) for their buoys.</p></li>
<li><p><code>EPS2</code> Spectral width parameter.</p></li>
<li><p><code>EPS4</code> Spectral width parameter.</p></li>
<li><p><code>DateTime</code> The date and time at the <em>end</em> of the burst.</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">wavesSP</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt;          h       Hm0        Tp         m0    T_0_1    T_0_2      EPS2</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; 1 10.57546 0.6408652 13.333333 0.02566926 8.737601 7.883780 0.4778399</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; 2 10.56555 0.5840453  7.058824 0.02131931 7.612296 7.085807 0.3925871</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; 3 10.54662 0.6003011 15.000000 0.02252259 8.792137 8.008713 0.4530032</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; 4 10.53129 0.7242003 13.333333 0.03277913 9.172417 8.399374 0.4387962</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt;        EPS4            DateTime</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; 1 0.7194393 2016-08-19 19:03:00</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; 2 0.6060098 2016-08-19 19:08:00</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; 3 0.6932648 2016-08-19 19:13:00</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; 4 0.6862625 2016-08-19 19:18:00</span></a></code></pre></div>
<p>Wave climate estimates based on spectral analysis methods are probably the more commonly used method, but the wave-by-wave analysis using the zero-crossing method is provided for interested users.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Go through each time chunk and calculate the wave</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># height and period of the de-trended data (removing tide signal).</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">wavesZC =<span class="st"> </span>owhlR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/owhlR/topics/processBursts">processBursts</a></span>(<span class="dt">Ht =</span> dat<span class="op">$</span>swDepthCorrected.m,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                          <span class="dt">times =</span> dat<span class="op">$</span>DateTime,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                          <span class="dt">burstLength =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">                          <span class="dt">Fs =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">                          <span class="dt">method =</span> <span class="st">'zc'</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">                          <span class="dt">tzone =</span> <span class="st">'UTC'</span>)</a></code></pre></div>
<p>The output statistics from the zero crossing algorithm are:</p>
<ul>
<li><p><code>Hsig</code> - Mean height of the highest 1/3 of waves in the data set. Units = same as input surface elevations, usually meters.</p></li>
<li><p><code>Hmean</code> - Overall mean wave height, for all waves (bigger than threshold). Units = same as input surface elevations.</p></li>
<li><p><code>H10</code> - Mean height of the upper 10% of all waves. Units = same as input surface elevations.</p></li>
<li><p><code>Hmax</code> - Maximum wave height in the input data. Units = same as input surface elevations.</p></li>
<li><p><code>Tmean</code> - Mean period of all waves (bigger than threshold). Units of seconds.</p></li>
<li><p><code>Tsig</code> - Mean period of <code>Hsig</code> (highest 1/3 of waves). Units of seconds.</p></li>
<li><p><code>DateTime</code> The date and time at the <em>end</em> of the burst.</p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">wavesZC</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#&gt;        Hsig     Hmean       H10      Hmax    Tmean      Tsig</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; 1 0.6486711 0.3998358 0.8180613 1.0486481 8.256944 10.229167</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt; 2 0.5430065 0.3715874 0.6600927 0.7113102 7.187500  9.346154</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; 3 0.5750452 0.3652376 0.7228948 0.7838407 7.717105 10.000000</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; 4 0.6684950 0.4227363 0.8561212 1.1252711 8.104167 10.291667</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt;              DateTime</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt; 1 2016-08-19 19:03:00</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt; 2 2016-08-19 19:08:00</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt; 3 2016-08-19 19:13:00</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt; 4 2016-08-19 19:18:00</span></a></code></pre></div>
<p>Next we can plot the estimated significant wave heights from the two different analysis methods (spectral and zero-crossing) for each of the analyzed bursts.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">ylims =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(wavesSP<span class="op">$</span>Hm0,wavesZC<span class="op">$</span>Hsig))</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">op&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> wavesSP<span class="op">$</span>DateTime,<span class="dt">y =</span> wavesSP<span class="op">$</span>Hm0, <span class="dt">type =</span> <span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">     <span class="dt">ylab =</span> <span class="st">'Significant wave</span><span class="ch">\n</span><span class="st"> height, m'</span>,</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">'Time'</span>,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">     <span class="dt">xaxt=</span><span class="st">'n'</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylim =</span> ylims)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/rect">rect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">1</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">3</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">2</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">4</span>],<span class="dt">col=</span>mybg)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/grid">grid</a></span>(<span class="dt">col =</span><span class="st">'white'</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/box">box</a></span>()</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> wavesSP<span class="op">$</span>DateTime, <span class="dt">y =</span> wavesSP<span class="op">$</span>Hm0, <span class="dt">type =</span> <span class="st">'b'</span>)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/axis">axis</a></span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime), </a>
<a class="sourceLine" id="cb18-12" data-line-number="12">     <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime),<span class="dt">format=</span><span class="st">'%H:%M'</span>) )</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> wavesZC<span class="op">$</span>DateTime, <span class="dt">y =</span> wavesZC<span class="op">$</span>Hsig, <span class="dt">type =</span> <span class="st">'b'</span>,</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">      <span class="dt">col =</span> <span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">'topleft'</span>,<span class="dt">legend=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Hm0, spectral method'</span>,<span class="st">'Hsig, zero-cross'</span>), </a>
<a class="sourceLine" id="cb18-17" data-line-number="17">       <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'black'</span>,<span class="st">'red'</span>), <span class="dt">lty =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">       <span class="dt">pch =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="figure">
<img src="OWHL-file-handling-vignette_files/figure-html/sigWavePlot-1.png" alt="Estimates of signficant wave height from each analyzed burst of samples, using either the spectral analysis method or zero-crossing method." width="768"><p class="caption">
Estimates of signficant wave height from each analyzed burst of samples, using either the spectral analysis method or zero-crossing method.
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(op)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">ylims =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">op&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> wavesSP<span class="op">$</span>DateTime,<span class="dt">y =</span> wavesSP<span class="op">$</span>Hm0, <span class="dt">type =</span> <span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">     <span class="dt">ylab =</span> <span class="st">'Period, seconds'</span>,</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">'Time'</span>,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">     <span class="dt">xaxt=</span><span class="st">'n'</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylim =</span> ylims)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/rect">rect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">1</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">3</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">2</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>()<span class="op">$</span>usr[<span class="dv">4</span>],<span class="dt">col=</span>mybg)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/grid">grid</a></span>(<span class="dt">col =</span><span class="st">'white'</span>)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/box">box</a></span>()</a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> wavesSP<span class="op">$</span>DateTime, <span class="dt">y =</span> wavesSP<span class="op">$</span>Tp, <span class="dt">type =</span> <span class="st">'b'</span>)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/axis">axis</a></span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime), </a>
<a class="sourceLine" id="cb20-12" data-line-number="12">     <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(dat<span class="op">$</span>DateTime),<span class="dt">format=</span><span class="st">'%H:%M'</span>) )</a>
<a class="sourceLine" id="cb20-13" data-line-number="13"></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> wavesZC<span class="op">$</span>DateTime, <span class="dt">y =</span> wavesZC<span class="op">$</span>Tsig, <span class="dt">type =</span> <span class="st">'b'</span>,</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">      <span class="dt">col =</span> <span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">'topleft'</span>,<span class="dt">legend=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'Peak period, spectral method'</span>,</a>
<a class="sourceLine" id="cb20-17" data-line-number="17">                          <span class="st">'Period of upper 1/3 of waves, zero-cross'</span>), </a>
<a class="sourceLine" id="cb20-18" data-line-number="18">       <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'black'</span>,<span class="st">'red'</span>), <span class="dt">lty =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb20-19" data-line-number="19">       <span class="dt">pch =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="figure">
<img src="OWHL-file-handling-vignette_files/figure-html/periodPlot-1.png" alt="Estimates of wave period from each analyzed burst of samples, using either the spectral analysis method or zero-crossing method." width="768"><p class="caption">
Estimates of wave period from each analyzed burst of samples, using either the spectral analysis method or zero-crossing method.
</p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(op)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#starting-out">Starting out</a></li>
      <li><a href="#importing-owhl-csv-files">Importing OWHL csv files</a></li>
      <li>
<a href="#converting-pressure-to-sea-surface-elevation">Converting pressure to sea surface elevation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#removing-atmospheric-pressure-and-sensor-offset">Removing atmospheric pressure and sensor offset</a></li>
      <li><a href="#isolate-the-subsurface-portion-of-the-dataset">Isolate the subsurface portion of the dataset</a></li>
      <li><a href="#convert-pressure-to-sea-surface-elevation">Convert pressure to sea surface elevation</a></li>
      <li><a href="#correcting-for-pressure-attenuation">Correcting for pressure attenuation</a></li>
      <li><a href="#calculating-wave-statistics">Calculating wave statistics</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Luke Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
